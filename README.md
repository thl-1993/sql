# SQL Beginner Projects

## Описание проектов

### 1. Day 00
- Выборка имен и возраста людей из города Казань.
- Имена и возраст женщин из Казани с сортировкой по имени.
- Пиццерии с рейтингом от 3.5 до 5 двумя способами (`>=, <=` и `BETWEEN`).
- Уникальные ID людей, посещавших пиццерии в указанные даты или пиццерию №2.
- Форматирование информации о человеке в строку.
- Имена людей, заказавших пиццы 13, 14, 18 без `IN` и `JOIN`.
- Добавление столбца `check_name` для проверки имени на 'Denis'.
- Разбиение людей на возрастные интервалы.
- Заказы с чётными ID из таблицы `person_order`.
- Имена людей и пиццерий с визитами с 7 по 9 января без `JOIN`.

---

### 2. Day 01
- Объединение списков пицц и людей с помощью `UNION`.
- Модификация объединенного списка с сортировкой.
- Уникальные названия пицц без `DISTINCT`, `GROUP BY`.
- Люди, посещавшие и заказывавшие пиццу в один день.
- Разность множеств ID заказов и визитов на дату.
- Перемножение людей и пиццерий (декартово произведение).
- Аналог ex03, но с именами.
- `JOIN` заказов с именами людей.
- Переписывание `JOIN` через `NATURAL JOIN`.
- Пиццерии без посещений через `IN` и `EXISTS`.
- Вывод имен людей, пицц и пиццерий через множественные `JOIN`.

---

### 3. Day 02
- Пиццерии с рейтингом без посещений.
- Пропущенные дни визитов через `generate_series`.
- Вывод людей и пиццерий за период, включая отсутствующих.
- CTE для пропущенных дней.
- Пиццы `mushroom` и `pepperoni` с ценами.
- Женщины старше 25 лет.
- Пиццы, заказанные Денисом или Анной.
- Пиццерия, где Дмитрий ел дешевле 800₽.
- Мужчины из Москвы и Самары с заказами `pepperoni` и `mushroom`.
- Женщины, заказавшие и `cheese`, и `pepperoni`.
- Люди, живущие по одному адресу.

---

### 4. Day 03
- Пиццы и пиццерии, посещенные Кейт, с ценами 800–1000 ₽.
- Найти меню, которое никто не заказывал.
- Пиццы и пиццерии с незаказанными позициями.
- Пиццерии, посещаемые чаще женщинами или мужчинами.
- Пиццерии с заказами только от одного пола.
- Пиццерии, где Андрей был, но не заказывал.
- Пиццы с одинаковыми ценами из разных пиццерий.
- Добавление пиццы "greek pizza" в Dominos.
- Добавление пиццы "sicilian pizza" без хардкода ID.
- Визиты Дениса и Ирины в Dominos 24 февраля.
- Заказы "sicilian pizza" Денисом и Ириной 24 февраля.
- Снижение цены на "greek pizza" на 10%.
- Массовая регистрация заказов на "greek pizza".
- Удаление всех новых заказов и "greek pizza".

---

### 5. Day 04
- Создание представлений с людьми по полу.
- Объединение представлений.
- Представление с датами января.
- Пропущенные дни визитов.
- Симметрическая разность посетителей 2 и 6 января.
- Представление заказов с 10% скидкой.
- Материализованное представление визитов Дмитрия.
- Добавление нового визита и обновление материала.
- Удаление всех виртуальных и материализованных представлений.

---

### 6. Day 05
- Создание BTree-индексов на внешние ключи.
- Проверка работы индексов через `EXPLAIN ANALYZE`.
- Функциональный индекс по верхнему регистру имени.
- Мультиколоночный индекс для оптимизации поиска.
- Уникальный индекс по пиццериям и названиям пицц.
- Частичный уникальный индекс на заказы 2022-01-01.
- Индексация для ускорения оконных функций.

---

### 7. Day 06
- Таблица `person_discounts` с внешними ключами и скидками.
- Заполнение таблицы на основе истории заказов.
- История заказов с учётом скидок.
- Уникальный индекс человек–пиццерия.
- Ограничения NOT NULL и диапазон скидок.
- Комментарии к таблице и полям.
- Создание последовательности `seq_person_discounts`.

---

### 8. Day 07
- Количество визитов по ID людей.
- Топ-4 людей по количеству визитов.
- Любимые пиццерии по количеству заказов и визитов.
- Сумма заказов и визитов по пиццериям.
- Люди с более чем 3 визитами.
- Уникальные имена заказчиков.
- Количество заказов, средняя, макс и мин цены по пиццериям.
- Средний рейтинг пиццерий.
- Адреса, пиццерии и количество заказов по городам.
- Формула `(max_age - min_age / max_age)` для адресов.

---

### 9. Day 08
- Демонстрация транзакции: `COMMIT`.
- Аномалия потерянного обновления при `READ COMMITTED`.
- Проверка потерянного обновления при `REPEATABLE READ`.
- Аномалия неповторяемого чтения при `READ COMMITTED`.
- Проверка неповторяемого чтения при `SERIALIZABLE`.
- Аномалия фантомного чтения при `READ COMMITTED`.
- Проверка фантомного чтения при `REPEATABLE READ`.
- Воспроизведение deadlock между транзакциями.

---

### 10. Day 09
- Аудит вставок: триггер на копирование новых записей.
- Аудит обновлений: триггер на сохранение старых значений.
- Аудит удалений: триггер на сохранение удаленных строк.
- Универсальный триггер insert/update/delete.
- Функции вместо представлений по полу.
- Параметризованная функция выборки людей.
- `plpgsql`-функция: пиццерии с ценами в заданный день.
- Функция поиска минимального элемента в массиве.
- Функция генерации чисел Фибоначчи.

---

### 11. Team 00
- Решение задачи коммивояжёра (TSP) на SQL.
- Поиск минимального тура между городами.
- Сортировка туров по минимальной и максимальной стоимости.

---

### 12. Team 01
- Построение DWH с агрегацией балансов пользователей.
- Вывод транзакций с расчетом стоимости валюты на ближайшую дату.

---

## Структура репозитория
```
SQL_beginner.Day00-1/
SQL_beginner.Day01-1/
SQL_beginner.Day02-1/
SQL_beginner.Day03-1/
SQL_beginner.Day04-1/
SQL_beginner.Day05-1/
SQL_beginner.Day06-1/
SQL_beginner.Day07-1/
SQL_beginner.Day08-1/
SQL_beginner.Day09-1/
SQL_beginner.Team_00-1/
SQL_beginner.Team01-1/
```

